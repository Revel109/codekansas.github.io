---
layout: code
filename: "wireworld.html"
---

<style>
#container {
    border: 1px solid black;
    margin-bottom: 10px;
}

.element {
    float: left;
}

.empty {
    background-color: black;
}

.head {
    background-color: blue;
}

.tail {
    background-color: red;
}

.conductor {
    background-color: yellow;
}
</style>
</head>
<body>
<h1>Wireworld</h1>

<div id="container"></div>

<button id="toggleButton" onclick="toggle()">Start</button>
<button onclick="step()">Step</button>
<button onclick="allEmpty()">Reset</button>
<button onclick="randomize()">Randomize</button>
<button onclick="randomCircle()">Draw Circle</button>
<button onclick="clearNonConductors()">Reset Conductors</button>

<h3 style="padding-top: 15px;">Getting Started</h3>

<p>
Click the "Start" button to run it. Click "Reset" to clear the screen and "Randomize" to fill it randomly with different types of cells. Click "Draw Circle" to draw a circle somewhere on the map (usually circles are a good starting point for more complicated structures). Click "Reset Conductors" to reset all head and tail cells to conductors. Each cell can be modified by clicking it.
</p>

<p>
This is a Javascript implementation of the Wireworld cellular automaton (another popular cellular automaton is Conway's Game of Life). This simulation consists of four types of cells, which are updated on each step of the simulation:

<ul>
    <li>Empty (black): They don't do anything</li>
    <li>Head (blue): They turn into tail cells after one step</li>
    <li>Tail (red): They turn into conductor cells after one step</li>
    <li>Conductor (yellow): They stay as conductors, unless they are bordered by exactly one or two head cells</li>
</ul>

The Wikipedia article <a href="https://en.wikipedia.org/wiki/Wireworld">here</a> gives more information.
<p>

<h3>Editing</h3>

<p>
This is a self-contained HTML page, so it can be downloaded and modified (in particular, the parameters in the script can be changed). I also wrote a command-line version in Python which can be found <a href="https://gist.github.com/codekansas/e0a94b5a5670e0a1228395885d618bb2">here</a>. Both were written after midnight, so take the code like you take your password hashes, with a grain of salt.
</p>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
<script type="text/javascript">
var width = 25, height = 25; // dimensions of grid, in number of cells
var running = false; // toggle flag
var interval; // for timing events
var stepTime = 200; // amount of time between steps

var cell_width = 25;
var cell_height = 25;
var cell_padding = 0.5;

function countNeighborsOfType(type, x, y, ignore) {
    var c = 0;
    for (var i = -1; i <= 1; i++) {
        for (var j = -1; j <= 1; j++) {
            if (!(i == 0 && j == 0) && getType(x+i, y+j) == type && !ignore.has(hash(x+i, y+j))) {
                c++;
            }
        }
    }
    return c;
}

function hash(x, y) {
    return x + '  ' + y;
}

function getType(x, y) {
    if (x < 0 || x >= width || y < 0 || y >= width) {
        return 'invalid';
    }

    var elem = $('#row_'+x+'_col_'+y);
    if (elem.hasClass('conductor')) {
        return 'conductor';
    } else if (elem.hasClass('head')) {
        return 'head';
    } else if (elem.hasClass('tail')) {
        return 'tail';
    } else {
        return 'empty';
    }
}

function setType(x, y, type) {
    var elem = $('#row_'+x+'_col_'+y);
    elem.removeClass(getType(x, y));
    elem.addClass(type);
}

function step() {
    var changed = new Set();
    for (var i = 0; i < height; i++) {
        for (var j = 0; j < width; j++) {
            if (getType(i, j) == 'conductor') {
                var neighborHeads = countNeighborsOfType('head', i, j, changed);
                if (neighborHeads == 1 || neighborHeads == 2) {
                    changed.add(hash(i, j));
                    setType(i, j, 'head');
                }
            }
        }
    }
    for (var i = 0; i < height; i++) {
        for (var j = 0; j < width; j++) {
            var type = getType(i, j);
            if (type == 'head' && !changed.has(hash(i, j))) {
                setType(i, j, 'tail');
            } else if (type == 'tail' && !changed.has(hash(i, j))) {
                setType(i, j, 'conductor');
            }
        }
    }
}

function randomClass() {
    var m = Math.random();
    if (m < 0.05) {
        return 'head';
    } else if (m < 0.1) {
        return 'tail';
    } else if (m < 0.4) {
        return 'conductor';
    } else {
        return 'empty';
    }
}

function toggle() {
    running = !running;
    if (running) {
        $("#toggleButton").html("Stop");
        interval = setInterval(step, stepTime);
    } else {
        $("#toggleButton").html("Start");
        clearInterval(interval);
        interval = false;
    }
}

function allEmpty() {
    for (var i = 0; i < height; i++) {
        for (var j = 0; j < width; j++) {
            setType(i, j, 'empty');
        }
    }
}

function randomize() {
    for (var i = 0; i < height; i++) {
        for (var j = 0; j < width; j++) {
            setType(i, j, randomClass());
        }
    }
}

function clearNonConductors() {
    for (var i = 0; i < height; i++) {
        for (var j = 0; j < width; j++) {
            var type = getType(i, j);
            if (type == 'head' || type == 'tail') {
                setType(i, j, 'conductor');
            }
        }
    }
}

function randomCircle() {
    var y = Math.floor(Math.random() * (width - 2)) + 1, x = Math.floor(Math.random() * (height - 2)) + 1;
    setType(x-1, y, 'conductor');
    setType(x, y-1, 'conductor');
    setType(x+1, y, 'tail');
    setType(x, y+1, 'head');
}

function init() {
    container = $("#container");
    container.css('height', ((cell_height + 2 * cell_padding) * height + 2 * cell_padding) + 'px');
    container.css('width', ((cell_width + 2 * cell_padding) * width + 2 * cell_padding) + 'px');
    for (var i = 0; i < height; i++) {
        container.append('<div id="row_'+i+'" class="row"></div>');
        for (var j = 0; j < width; j++) {
            $('#row_'+ i).append('<div id="row_'+i+'_col_'+j+'" class="element empty"></div>');
        }
    }

    elements = $('.element');
    elements.css('width', cell_width + 'px');
    elements.css('height', cell_height + 'px');
    elements.css('margin', cell_padding + 'px');

    randomCircle();

    $(".element").click(function() {
        if ($(this).hasClass('empty')) {
            $(this).removeClass('empty');
            $(this).addClass('conductor');
        } else if ($(this).hasClass('head')) {
            $(this).removeClass('head');
            $(this).addClass('tail');
        } else if ($(this).hasClass('tail')) {
            $(this).removeClass('tail');
            $(this).addClass('empty');
        } else if ($(this).hasClass('conductor')) {
            $(this).removeClass('conductor');
            $(this).addClass('head');
        }
    });
}

$(document).ready(function() {
    init();
});
</script>
